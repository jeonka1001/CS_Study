# 면접준비 - DataBase
> 나만의 언어로 준비하는 면접준비

## 목록
- [트랜잭션](#트랜잭션)
- [PK vs FK](#pk-vs-fk)
- [인덱스](#인덱스)
- [join](#join)
- [정규화](#정규화)

----
## DDL DML DCL
- DDL(database define language)
    - 데이터 베이스 정의어
    - 데이터 베이스에 데이터 구조를 정의하는 명령어
    - create, alter, drop, rename,truncate 등이 있다
- DML ( database manipulation language)
    - 데이터 베이스 조작어 ( CURD )
    - 데이터 베이스의 데이터를 조작하는 명령어
    - insert update delete select 등
- DCL ( database control language)
    - 데이터 베이스 제어어
    - 데이터 베이스에 권한을 주고 수거하는 명령어
    - grant revoke

#### delete vs truncate vs drop
||delete|truncate|drop|
|--|--|--|--|
|테이블|존재|존재|삭제|
|저장공간|유지|반납|반납|
|되돌리기|가능|불가능|불가능|
|구문 종류|DML|DDL|DDL|
|부분삭제|가능|불가능|불가능|

---

## 트랜잭션
> 한꺼번에 수행되어야 할 연산의 단위
- 여러개의 쿼리가 하나의 트랜잭션이라 할 수 있으며, 하나의 쿼리 또한 트랜잭션이라 할 수 있다.
- 트랜잭션이 정상적으로 완료되었을 시 commit 하여 DB에 반영하고, 도중에 문제가 있었을 시 rollback 하여 이전 상태로 되돌립니다.

### ACID
- A( atomicity ) 원자성
    - 트랜잭션 연산은 DB에 모두 반영되거나 반영되지 않아야 한다.
    - 즉, 연산 중간에 하나라도 완벽히 수행되지 않으면 전부 취소해야함.
- C ( consistency ) 일관성
    - 시스템이 가진 고정 요소는 트랜잭선 수행 전,후 가 같아야 한다.
    - 트랜잭션 성공 후 일관성 있는 상태로 DB를 유지해야 한다.
- I ( Isolation ) 독립성
    - 둘 이상의 트랜잭션이 진랭되는 경우 하나의 트랜잭션이 다른 하나에 끼어들 수 없다.
    - 수행중인 트랜잭션은 다른 트랜잭션의 값을 참조할 수 없다
- Durablility ( 지속성 )
    - 성공적으로 수행된 트랜잭션 결과는 영구적으로 반영되어야 한다.

#### 동시성 제어
> 데이터 베이스의 일관성과 독립성을 유지하기 위해 동시성을 제어한다.
- 둘 이상의 트랜잭션이 하나의 자원에 접근할 때 이를 제어함
- 발생 할 수 있는 문제점
    1. 읽기 & 쓰기 : 오손읽기, 유령 데이터 읽기, 반복 불가능 읽기
    2. 쓰기 & 쓰기 : 갱신 손실, 모순성, 연쇄 복구
#### 트랜잭션 격리 수준
- 동시에 여러 트랜잭션을 처리할 시 특정 트랜잭션이 다른 트랜잭션이 변경, 조회 하는 테이블을 보는 것을 허용 할지 말지 결정하는 것
- ```READ UNCOMMITED``` , ```READ COMMITED``` , ```REPEATABLE READ``` , ```SERIALIZABLE```

###### READ UNCOMMITED
- commit 혹은 rollback 여부에 상관 없이 조회 가능한 수준
- 이 경우 T2 가 읽은 작업이 T1에 의해 rollback 되면 실제 값과 T2 가 읽은 값이 다를 수 있다.
###### READ COMMITED 
- undo 영역에 있는 데이터를 가져와 읽는것이 가능함. 즉, 해당 테이블에 트랜잭션이 진행중이면 작업 전 데이터를 읽는다.
- 이 경우 작업 진행중인 T2 가 다시 이 전과 같은 select 문을 수행한다면 값이 달라질 수 있다.
###### REPEATABLE READ 
> InnoDB 의 기본 격리 수준이다.  
- 트랜잭션 시작을 기준으로 아이디를 부여하며 아이디가 낮은 트랜잭션에서 변경한 것만 읽히게 한다.
- 1개 데이터 조회 시 문제가 발생하지 않는다.
- 여러 건의 데이터 조회 시 없던 데이터( 높은 아이디의 트랜잭션이 insert 한 데이터 )가 갑자기 생길 수 있다.
###### SERIALIZABLE READ
- 선행 트랜잭션이 작업을 완료하기 전까지 후행 트랜잭션은 해당 테이블에 어떠한 작업도 할 수 없는 것
- lock 과 비슷한 개념이라 생각하면 된다.

---
## PK vs UK
- 두 속성 모두 해당 컬럼을 중복되지 않게 해준다는 공통점이 있다. 그러나 차이점은 ?  

||PK|UK|
|--|--|--|
|NULL|불가|허용|
|참조무결성|가능|불가능|
|지정 개수|1개만|여러개 가능|
|클러스터 인덱스|사용|사용하지않음|
**클러스터 인덱스** : 입력된 데이터를 클러스터 인덱스를 통해 물리적으로 재배열 한다.

---

## 인덱스 
- 테이블의 데이터 검색 속도를 높여주는 자료구조
- 기존 데이터를 조회하기 위해서는 테이블을 full scan 하며 데이터를 조회한다.
- 인덱스는 모든 페이지를 full scan 하지 않고, 찾고자 하는 인덱스의 자식 노드로 수직 스캔해서 리프노드가 나올 시 해당 리프 노드를 range scan 하는 방식으로 스캔한다.

#### full scan vs range scan
- full scan 
    - 인덱스 리프 노드를 처음부터 끝까지 스캔하는 방식
    - multi block i/o 가 이루어 진다.
- range scan 
    - 찾고자 하는 데이터가 있는 범위의 리프 노드만 스캔하며 찾은 방식
    - single block i/o 가 이루어 진다.
- 즉, 인접한 여러개의 데이터를 찾을 시 ```full scan``` 이 적합하며, 특정 조건에 맞는 소수의 데이터를 찾는 경우 ```range scan``` 이 적합하다.


#### Index가 사용하는 자료구조 B-Tree
- 자식 노드의 개수가 2개 이상인 트리
- 인덱스의 컬럼과 이에 해당하는 데이터가 들어있는 페이지 주소를 같이 저장한 후 자식 노드로 해당 페이지를 가리킨다.
- 실제 데이터가 들어있는 페이지는 리프노드이다.
- 따라서 실제 데이터를 꺼낼 시 리프노드에서 꺼내온다.

## Join
- 

## 정규화

